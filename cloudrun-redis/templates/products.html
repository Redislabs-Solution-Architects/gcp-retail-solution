<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Album example Â· Bootstrap v5.2</title>

        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css"
        />

        <style>
            /* Chrome, Safari, Edge, Opera */
            input::-webkit-outer-spin-button,
            input::-webkit-inner-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }

            /* Firefox */
            input[type='number'] {
                -moz-appearance: textfield;
            }
            .bd-placeholder-img {
                font-size: 1.125rem;
                text-anchor: middle;
                -webkit-user-select: none;
                -moz-user-select: none;
                user-select: none;
            }

            @media (min-width: 768px) {
                .bd-placeholder-img-lg {
                    font-size: 3.5rem;
                }
            }

            .b-example-divider {
                height: 3rem;
                background-color: rgba(0, 0, 0, 0.1);
                border: solid rgba(0, 0, 0, 0.15);
                border-width: 1px 0;
                box-shadow: inset 0 0.5em 1.5em rgba(0, 0, 0, 0.1),
                    inset 0 0.125em 0.5em rgba(0, 0, 0, 0.15);
            }

            .b-example-vr {
                flex-shrink: 0;
                width: 1.5rem;
                height: 100vh;
            }

            .bi {
                vertical-align: -0.125em;
                fill: currentColor;
            }

            .nav-scroller {
                position: relative;
                z-index: 2;
                height: 2.75rem;
                overflow-y: hidden;
            }

            .nav-scroller .nav {
                display: flex;
                flex-wrap: nowrap;
                padding-bottom: 1rem;
                margin-top: -1px;
                overflow-x: auto;
                text-align: center;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
        </style>
    </head>

    <body>
        <header>
            <div class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark shadow-sm">
                <div class="container">
                    <a href="#" class="navbar-brand d-flex align-items-center">
                        <strong>Active-Active Store</strong>
                    </a>
                    <div class="d-flex align-items-center">
                        <span class="text-info me-3">{{ gcp_region }}</span>

                        {% if 'cart_item' in session and
                        session['cart_item']|length > 0 %}
                        <ul class="navbar-nav me-auto my-2 my-lg-0">
                            <li class="nav-item dropdown">
                                <a
                                    class="nav-link dropdown-toggle"
                                    href="#"
                                    role="button"
                                    data-bs-toggle="dropdown"
                                    aria-expanded="false"
                                >
                                    <span class="text-white">
                                        {{ session['cart_item']|length }}
                                        <i class="bi bi-cart"></i>
                                    </span>
                                </a>
                                <ul class="dropdown-menu p-2" style="width: 400px; left:-340px;">
                                    {% for key, val in
                                    session['cart_item'].items() %} {% set
                                    quantity =
                                    session['cart_item'][key]['quantity'] %} {%
                                    set price =
                                    session['cart_item'][key]['price'] %} {% set
                                    item_price =
                                    session['cart_item'][key]['total_price'] %}
                                    <li
                                        class="d-flex pt-3 border-bottom justify-content-between"
                                    >
                                        <img
                                            src="/static/images/{{ session['cart_item'][key]['image'] }}"
                                            width="40"
                                            height="40"
                                        />
                                        <p class="pb-3 mb-0 small lh-sm me-5">
                                            <strong
                                                class="d-block text-gray-dark"
                                                >[{{
                                                session['cart_item'][key]['code']
                                                }}]{{
                                                session['cart_item'][key]['name']
                                                }}</strong
                                            >
                                            {{ quantity }} x {{ price |
                                            currencyFormat }} = {{ item_price |
                                            currencyFormat }}
                                        </p>
                                        <p
                                            class="pb-3 mb-0 small lh-sm ps-4 fs-4"
                                        >
                                            <a
                                                class=""
                                                href="{{ url_for('.delete_product', code=session['cart_item'][key]['code']) }}"
                                            >
                                                <i class="bi bi-trash"></i>
                                            </a>
                                        </p>
                                    </li>
                                    {% endfor %}
                                    <li
                                        class="d-flex pt-3 border-bottom justify-content-end"
                                    >
                                        <p class="pb-3 mb-0 small lh-sm">
                                            <strong
                                                class="d-block text-gray-dark"
                                                >Total: {{
                                                session['sub_total_price'] |
                                                currencyFormat }}</strong
                                            >
                                        </p>
                                    </li>
                                    <li class="d-flex pt-3 justify-content-end">
                                        <a
                                            class="btn btn-danger btn-sm me-3"
                                            id="btnEmpty"
                                            href="{{ url_for('.empty_cart') }}"
                                            >Empty Cart</a
                                        >
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        {% else %}
                        <span class="text-white">
                            <i class="bi bi-cart"></i>
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </header>

        <main>
            <section class="py-5 text-center container">
                <div class="row py-lg-5">
                    <div class="col-lg-6 col-md-8 mx-auto">
                        <h1 class="fw-light">Redis Active-Active Store</h1>
                        <p class="lead text-muted">
                            This sample storefront demonstrates how to use
                            Active-Active to enable local read and write
                            latencies wherever you are! Look at the region at
                            the top of the screen to know where you are
                            connecting from.
                        </p>
                    </div>
                </div>
            </section>

            <div class="album py-5 bg-light">
                <div class="container">
                    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                        {% for product in products %}
                        <div class="col">
                            <div class="card shadow-sm">
                                <img
                                    class="mx-auto p-2"
                                    width="225"
                                    height="225"
                                    src="/static/images/{{ product.image }}"
                                />

                                <div class="card-body">
                                    <h5 class="card-title">
                                        {{ product.name }}
                                    </h5>
                                    <div
                                        class="d-flex justify-content-between align-items-center"
                                    >
                                        <div class="btn-group">
                                            <form method="post" action="/add">
                                                <div class="cart-action">
                                                    <input
                                                        type="hidden"
                                                        name="code"
                                                        value="{{ product.code }}"
                                                    />
                                                    <input
                                                        style="
                                                            vertical-align: middle;
                                                        "
                                                        type="number"
                                                        class="text-center"
                                                        name="quantity"
                                                        value="1"
                                                        size="2"
                                                    />
                                                    <input
                                                        type="submit"
                                                        value="Add to Cart"
                                                        class="btn btn-primary"
                                                    />
                                                </div>
                                            </form>
                                        </div>
                                        <small class="text-muted"
                                            >{{ product.price | currencyFormat
                                            }}</small
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </main>
        <script
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js"
            integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"
            integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK"
            crossorigin="anonymous"
        ></script>
    </body>
</html>
